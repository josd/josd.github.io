# ANSWER
{
  "permitted": [
    {
      "id": "u1",
      "name": "Ana Jensen",
      "purpose": "marketing",
      "region": "EU",
      "lawful_basis": "consent",
      "approved_fields": [
        "email"
      ],
      "allowed_fields_for_purpose": [
        "email"
      ],
      "retention_days_effective": 120
    },
    {
      "id": "u2",
      "name": "Bram Costa",
      "purpose": "analytics",
      "region": "EU",
      "lawful_basis": "consent",
      "approved_fields": [
        "user_id"
      ],
      "allowed_fields_for_purpose": [
        "user_id"
      ],
      "retention_days_effective": 365
    },
    {
      "id": "u3",
      "name": "Cleo Ibarra",
      "purpose": "support",
      "region": "US",
      "lawful_basis": "legitimate_interest",
      "approved_fields": [
        "email",
        "ticket_id"
      ],
      "allowed_fields_for_purpose": [
        "email",
        "phone",
        "ticket_id"
      ],
      "retention_days_effective": 400
    },
    {
      "id": "u7",
      "name": "Gita Verma",
      "purpose": "analytics",
      "region": "EU",
      "lawful_basis": "consent",
      "approved_fields": [
        "user_id"
      ],
      "allowed_fields_for_purpose": [
        "user_id"
      ],
      "retention_days_effective": 180
    },
    {
      "id": "u8",
      "name": "Hugo Müller",
      "purpose": "marketing",
      "region": "EU",
      "lawful_basis": "consent",
      "approved_fields": [
        "email"
      ],
      "allowed_fields_for_purpose": [
        "email"
      ],
      "retention_days_effective": 90
    }
  ]
}

# REASONS
- Ana Jensen (u1) → purpose=marketing, region=EU, basis=consent, age=34, parental_consent=False, processor=False, dpa_signed=True. Fields ok: True. Retention capped at 120 days.
- Bram Costa (u2) → purpose=analytics, region=EU, basis=consent, age=15, parental_consent=True, processor=True, dpa_signed=True. Fields ok: True. Retention capped at 365 days.
- Cleo Ibarra (u3) → purpose=support, region=US, basis=legitimate_interest, age=28, parental_consent=False, processor=False, dpa_signed=False. Fields ok: True. Retention capped at 400 days.
- EU data subject <16 needs parental consent.
- EU processor role requires a DPA to be signed.
- Requested fields ['user_id', 'email'] exceed allowed ['user_id'] for analytics.
- Gita Verma (u7) → purpose=analytics, region=EU, basis=consent, age=40, parental_consent=False, processor=True, dpa_signed=True. Fields ok: True. Retention capped at 180 days.
- Hugo Müller (u8) → purpose=marketing, region=EU, basis=consent, age=16, parental_consent=False, processor=False, dpa_signed=True. Fields ok: True. Retention capped at 90 days.

Wrote ./cases/bus/odrl/permitted_processing.json

# CHECK (harness) — detailed
Check 1 — Data minimization: approved_fields ⊆ allowed_fields_for_purpose:
  - u1 subset_ok=True (['email'] ⊆ ['email'])
  - u2 subset_ok=True (['user_id'] ⊆ ['user_id'])
  - u3 subset_ok=True (['email', 'ticket_id'] ⊆ ['email', 'phone', 'ticket_id'])
  - u7 subset_ok=True (['user_id'] ⊆ ['user_id'])
  - u8 subset_ok=True (['email'] ⊆ ['email'])
Check 2 — Retention caps respected:
  - u1 effective=120 ≤ cap=180
  - u2 effective=365 ≤ cap=365
  - u3 effective=400 ≤ cap=730
  - u7 effective=180 ≤ cap=365
  - u8 effective=90 ≤ cap=180
Check 3 — Denied list contains clear reasons:
  - u4 reason_present=True
  - u5 reason_present=True
  - u6 reason_present=True
Check 4 — Schema essentials:
  - field 'reference_date': present
  - field 'policy': present
  - field 'permitted': present
  - field 'denied': present
✔ All checks passed.
