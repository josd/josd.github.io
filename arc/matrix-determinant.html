<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Matrix Determinant • det(AB) = det(A)·det(B)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f7f8fb;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#4b5563;
      --accent:#2563eb;
      --ok:#059669;
      --bad:#b91c1c;
      --radius:16px;
      --shadow:0 10px 22px rgba(2,6,23,.06), 0 2px 6px rgba(2,6,23,.06);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 var(--sans);-webkit-font-smoothing:antialiased}
    .wrap{max-width:980px;margin:auto;padding:28px 16px 64px}
    header{display:flex;flex-direction:column;gap:10px;margin-bottom:22px}
    h1{font-size:clamp(24px,3vw,34px);line-height:1.2;margin:0}
    .sub{color:var(--muted)}
    .pill{display:inline-flex;align-items:center;gap:8px;background:#eef2ff;color:#3730a3;border-radius:999px;padding:8px 12px;font-weight:600;font-size:14px;width:max-content}
    .grid{display:flex;flex-direction:column;gap:16px}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;border:1px solid #eef2f7}
    .kicker{font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:#6b7280}
    .muted{color:var(--muted)}
    .answer{font-size:18px;font-weight:800}
    .ok{color:var(--ok)}
    .fail{color:var(--bad);font-weight:800}
    .result{margin-top:10px;padding:10px 12px;border-radius:10px;background:#fafbff;border:1px dashed #d7dbe5}
    code, pre{font-family:var(--mono)}
    pre{
      background:#fafbff;color:#0f172a;padding:14px;border-radius:12px;
      white-space: pre-wrap; overflow-wrap:anywhere; word-break:break-word;
      overflow-x:hidden; overflow-y:auto; max-width:100%;
    }
    .small{font-size:13px}
    textarea.input{
      width:100%;min-height:96px;padding:10px 12px;border-radius:10px;border:1px solid #d9e1f1;background:#fdfefe;font-family:var(--mono)
    }
    .badge{display:inline-block;font-size:12px;padding:2px 8px;border-radius:999px;background:#ecfeff;color:#155e75;border:1px solid #a5f3fc}
    .mat{display:inline-block;padding:6px 10px;border:1px solid #e5eaf3;border-radius:10px;background:#fff;box-shadow:var(--shadow);font-family:var(--mono)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Matrix Determinant • det(AB) = det(A)·det(B)</h1>
    </header>

    <section class="grid">
      <!-- Problem -->
      <article class="card">
        <div class="kicker">Problem</div>
        <h2>Show det(AB) equals det(A) times det(B) for square matrices A, B</h2>
        <p class="small muted">We illustrate with 2×2 and 3×3 integer matrices and multiple independent checks.</p>
      </article>

      <!-- Answer -->
      <article class="card">
        <div class="kicker">Answer</div>
        <p class="answer ok">True. For all square matrices A, B of the same size, det(AB) = det(A)·det(B).</p>
      </article>

      <!-- Reason Why -->
      <article class="card">
        <div class="kicker">Reason Why</div>
        <h2>Mathematical English justification (elementary matrices argument)</h2>
        <ol>
          <li>Consider the three elementary row operations, implemented by left-multiplying with an elementary matrix E:
            <ul>
              <li>Swap two rows: det(E) = −1 and det(EA) = −det(A).</li>
              <li>Scale row i by λ: det(E) = λ and det(EA) = λ·det(A).</li>
              <li>Add λ times row j to row i (i ≠ j): det(E) = 1 and det(EA) = det(A).</li>
            </ul>
            In each case, det(EA) = det(E)·det(A).
          </li>
          <li>Every invertible matrix A can be written as a product of elementary matrices: A = E_k … E_1. Then
            det(AB) = det(E_k … E_1 B) = det(E_k) … det(E_1) det(B) = det(A) det(B).
          </li>
          <li>If A is singular, then AB is singular, so det(AB) = 0 = det(A) det(B). Therefore the identity holds for all A, B.</li>
        </ol>
      </article>

      <!-- Checks (7 harnesses) -->
      <article class="card" id="h1">
        <div class="kicker">Check (harness) #1</div>
        <h3>Fixed example (3×3)</h3>
        <p class="small muted">Compute det(AB) and compare with det(A)·det(B).</p>
        <div class="result" id="r1"></div>
      </article>

      <article class="card" id="h2">
        <div class="kicker">Check (harness) #2</div>
        <h3>Random 3×3 integer matrices (200 trials)</h3>
        <p class="small muted">Entries from −3..3. We use the exact 3×3 formula (no floating error).</p>
        <div class="result" id="r2"></div>
      </article>

      <article class="card" id="h3">
        <div class="kicker">Check (harness) #3</div>
        <h3>Upper-triangular matrices</h3>
        <p class="small muted">For triangular U, V: det(UV) equals product of diagonals of U times product of diagonals of V.</p>
        <div class="result" id="r3"></div>
      </article>

      <article class="card" id="h4">
        <div class="kicker">Check (harness) #4</div>
        <h3>Elementary matrices</h3>
        <p class="small muted">Pick a random A and a random elementary E. Verify det(EA) = det(E)·det(A) for each type.</p>
        <div class="result" id="r4"></div>
      </article>

      <article class="card" id="h5">
        <div class="kicker">Check (harness) #5</div>
        <h3>Singular case</h3>
        <p class="small muted">If det(A) = 0, then det(AB) must be 0 for any B.</p>
        <div class="result" id="r5"></div>
      </article>

      <article class="card" id="h6">
        <div class="kicker">Check (harness) #6</div>
        <h3>Your matrices (CSV)</h3>
        <p class="small muted">Enter 2×2 or 3×3 matrices as rows separated by semicolons. Examples:<br>
          <code>A: 1,2; 3,4</code><br><code>B: 2,0; 5,1</code> or<br>
          <code>A: 1,0,2; -1,3,1; 0,2,1</code></p>
        <textarea class="input" id="csv" placeholder="A: 1,2; 3,4
B: 2,0; 5,1"></textarea>
        <div class="result" id="r6"></div>
      </article>

      <article class="card" id="h7">
        <div class="kicker">Check (harness) #7</div>
        <h3>Power rule (consequence)</h3>
        <p class="small muted">det(A^k) = det(A)^k for k = 2,3,4 (follows from multiplicativity).</p>
        <div class="result" id="r7"></div>
      </article>
    </section>
  </div>

  <script>
    // ---------- Matrix helpers ----------
    const mul = (A,B)=>{
      const r=A.length, c=B[0].length, k=A[0].length;
      const C=Array.from({length:r},()=>Array(c).fill(0));
      for(let i=0;i<r;i++) for(let j=0;j<c;j++){
        let s=0; for(let t=0;t<k;t++) s+=A[i][t]*B[t][j]; C[i][j]=s;
      }
      return C;
    };
    const powMat = (A,k)=>{
      let R = eye(A.length), X = A.map(row=>row.slice());
      let n = k;
      while(n>0){
        if(n&1) R = mul(R,X);
        if(n>1) X = mul(X,X);
        n>>=1;
      }
      return R;
    };
    const eye = n => Array.from({length:n},(_,i)=>Array.from({length:n},(_,j)=>i===j?1:0));
    const fmt = M => `[${M.map(r=>'['+r.join(', ')+']').join(', ')}]`;

    // Determinants (exact for 2×2 and 3×3)
    const det2 = M => M[0][0]*M[1][1] - M[0][1]*M[1][0];
    const det3 = M => {
      const a=M[0][0], b=M[0][1], c=M[0][2];
      const d=M[1][0], e=M[1][1], f=M[1][2];
      const g=M[2][0], h=M[2][1], i=M[2][2];
      return a*(e*i - f*h) - b*(d*i - f*g) + c*(d*h - e*g);
    };
    const det = M => (M.length===2?det2(M):det3(M));

    // Random small matrices
    const rint = (a,b)=> a + Math.floor(Math.random()*(b-a+1));
    const randomMat = n => Array.from({length:n},()=>Array.from({length:n},()=>rint(-3,3)));

    // Upper-triangular with small ints
    const randomUpper = n => {
      const M = Array.from({length:n},()=>Array(n).fill(0));
      for(let i=0;i<n;i++) for(let j=i;j<n;j++) M[i][j]=rint(-3,3);
      return M;
    };

    // Elementary matrices (left-multiplying does the row op)
    const E_swap = (n,i,j)=>{ const E=eye(n); [E[i],E[j]]=[E[j],E[i]]; return E; };
    const E_scale = (n,i,lam)=>{ const E=eye(n); E[i][i]=lam; return E; };
    const E_add = (n,i,j,lam)=>{ const E=eye(n); E[i][j]=lam; return E; };

    // Parse CSV matrices: "A: 1,2; 3,4" or 3×3 variant
    function parseCSVSpec(text){
      const get = (k)=>{
        const m = (text||'').match(new RegExp(`^\\s*${k}\\s*:\\s*([^\\n]+)$`,'mi'));
        if(!m) return null;
        const rows = m[1].split(';').map(s=>s.trim()).filter(Boolean);
        const mat = rows.map(r=>r.split(',').map(x=>Number(x.trim())));
        const n = mat.length;
        if(n!==2 && n!==3) return null;
        if(mat.some(row=>row.length!==n || row.some(v=>Number.isNaN(v)))) return null;
        return mat;
      };
      return {A:get('A'), B:get('B')};
    }

    // ---------- Harness #1: fixed example ----------
    function check1(){
      const A = [[1,2,0],[0,1,3],[2,0,1]];
      const B = [[2,1,0],[0,1,1],[1,0,2]];
      const AB = mul(A,B);
      const lhs = det3(AB);
      const rhs = det3(A) * det3(B);
      const pass = lhs===rhs;
      const msg = `A = ${fmt(A)}\nB = ${fmt(B)}\nAB = ${fmt(AB)}\ndet(AB) = ${lhs}\ndet(A)·det(B) = ${rhs}`;
      document.getElementById('r1').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #2: random pairs ----------
    function check2(){
      const trials=200; let ok=0;
      for(let t=0;t<trials;t++){
        const A=randomMat(3), B=randomMat(3);
        const lhs = det3(mul(A,B));
        const rhs = det3(A)*det3(B);
        if(lhs===rhs) ok++;
      }
      const pass = ok===trials;
      const msg = `Trials: ${trials}\nMatches: ${ok}\nMismatches: ${trials-ok}`;
      document.getElementById('r2').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #3: triangular ----------
    function check3(){
      const U = randomUpper(3), V = randomUpper(3);
      const UV = mul(U,V);
      const detU = U[0][0]*U[1][1]*U[2][2];
      const detV = V[0][0]*V[1][1]*V[2][2];
      const lhs = det3(UV);
      const rhs = detU*detV;
      const pass = lhs===rhs;
      const msg = `U = ${fmt(U)}\nV = ${fmt(V)}\nUV = ${fmt(UV)}\ndet(UV) = ${lhs}\nprod(diag U)·prod(diag V) = ${rhs}`;
      document.getElementById('r3').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #4: elementary matrices ----------
    function check4(){
      const n=3, A=randomMat(n);
      const tests=[];
      // swap rows 0 and 1
      let E=E_swap(n,0,1); tests.push({name:"swap", ok: det3(mul(E,A))===(-1)*det3(A)});
      // scale row 2 by λ
      const lam = rint(-3,3) || 2;
      E=E_scale(n,2,lam); tests.push({name:`scale row by ${lam}`, ok: det3(mul(E,A))===lam*det3(A)});
      // add λ times row 0 to row 1
      const lam2 = (rint(-2,2)===0?1:rint(-2,2));
      E=E_add(n,1,0,lam2); tests.push({name:`row1 += ${lam2}·row0`, ok: det3(mul(E,A))===det3(A)});
      const pass = tests.every(t=>t.ok);
      const lines = tests.map(t=>`${t.name}: ${t.ok ? 'true' : 'false'}`);
      document.getElementById('r4').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${lines.join('\n')}</pre>`;
    }

    // ---------- Harness #5: singular case ----------
    function check5(){
      // Make A singular by duplicating a row
      const A = [[1,2,3],[1,2,3],[0,1,1]];
      const B = randomMat(3);
      const lhs = det3(mul(A,B));
      const rhs = det3(A)*det3(B);
      const pass = lhs===0 && rhs===0;
      const msg = `A (singular) = ${fmt(A)}\nB = ${fmt(B)}\nAB = ${fmt(mul(A,B))}\ndet(A) = ${det3(A)}\ndet(B) = ${det3(B)}\ndet(AB) = ${lhs}\ndet(A)·det(B) = ${rhs}`;
      document.getElementById('r5').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #6: your data ----------
    function check6(){
      const {A,B} = parseCSVSpec(document.getElementById('csv').value);
      if(!A || !B){
        document.getElementById('r6').innerHTML =
          `<div class="fail">FAIL</div><pre>Could not parse.\nExamples:\nA: 1,2; 3,4\nB: 2,0; 5,1\n\nA: 1,0,2; -1,3,1; 0,2,1</pre>`;
        return;
      }
      if(A.length!==B.length){
        document.getElementById('r6').innerHTML =
          `<div class="fail">FAIL</div><pre>Matrix sizes must match (both 2×2 or both 3×3).</pre>`;
        return;
      }
      const AB = mul(A,B);
      const lhs = det(AB);
      const rhs = det(A)*det(B);
      const pass = lhs===rhs;
      const msg = `A = ${fmt(A)}\nB = ${fmt(B)}\nAB = ${fmt(AB)}\ndet(AB) = ${lhs}\ndet(A)·det(B) = ${rhs}`;
      document.getElementById('r6').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #7: power rule ----------
    function check7(){
      const A = randomMat(3);
      const ks = [2,3,4];
      const dA = det3(A);
      const lines=[];
      let ok=true;
      for(const k of ks){
        const Ak = powMat(A,k);
        const lhs = det3(Ak);
        const rhs = Math.round(dA**k); // exact for integers
        const good = lhs===rhs;
        ok = ok && good;
        lines.push(`k=${k}: det(A^${k}) = ${lhs} ; det(A)^${k} = ${rhs}  ${good?'✓':'✗'}`);
      }
      document.getElementById('r7').innerHTML =
        `<div class="${ok?'ok':'fail'}">${ok?'PASS':'FAIL'}</div><pre>${lines.join('\n')}</pre>`;
    }

    // Autorun
    window.addEventListener('DOMContentLoaded', ()=>{
      const csv = document.getElementById('csv');
      if(csv && !csv.value.trim()) csv.value = "A: 1,2; 3,4\nB: 2,0; 5,1";
      check1(); check2(); check3(); check4(); check5(); check6(); check7();
    });
  </script>
</body>
</html>

