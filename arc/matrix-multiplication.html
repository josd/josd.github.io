<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Matrix Multiplication • Not Commutative (AB ≠ BA)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f7f8fb;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#4b5563;
      --accent:#2563eb;
      --ok:#059669;
      --bad:#b91c1c;
      --radius:16px;
      --shadow:0 10px 22px rgba(2,6,23,.06), 0 2px 6px rgba(2,6,23,.06);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 var(--sans);-webkit-font-smoothing:antialiased}
    .wrap{max-width:980px;margin:auto;padding:28px 16px 64px}
    header{display:flex;flex-direction:column;gap:10px;margin-bottom:22px}
    h1{font-size:clamp(24px,3vw,34px);line-height:1.2;margin:0}
    .sub{color:var(--muted)}
    .pill{display:inline-flex;align-items:center;gap:8px;background:#eef2ff;color:#3730a3;border-radius:999px;padding:8px 12px;font-weight:600;font-size:14px;width:max-content}
    .grid{display:flex;flex-direction:column;gap:16px}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;border:1px solid #eef2f7}
    .kicker{font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:#6b7280}
    .muted{color:var(--muted)}
    .answer{font-size:18px;font-weight:800}
    .ok{color:var(--ok)}
    .fail{color:var(--bad);font-weight:800}
    .result{margin-top:10px;padding:10px 12px;border-radius:10px;background:#fafbff;border:1px dashed #d7dbe5}
    code, pre{font-family:var(--mono)}
    pre{
      background:#fafbff;
      color:#0f172a;
      padding:14px;
      border-radius:12px;
      white-space: pre-wrap;
      overflow-wrap: anywhere;
      word-break: break-word;
      overflow-x: hidden;
      overflow-y: auto;
      max-width: 100%;
    }
    .small{font-size:13px}
    textarea.input{
      width:100%;min-height:92px;padding:10px 12px;border-radius:10px;border:1px solid #d9e1f1;background:#fdfefe;font-family:var(--mono)
    }
    .badge{display:inline-block;font-size:12px;padding:2px 8px;border-radius:999px;background:#ecfeff;color:#155e75;border:1px solid #a5f3fc}
    .mat{display:inline-block;padding:6px 10px;border:1px solid #e5eaf3;border-radius:10px;background:#fff;box-shadow:var(--shadow);font-family:var(--mono)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Matrix Multiplication • Not Commutative (AB ≠ BA)</h1>
    </header>

    <section class="grid">
      <!-- Problem statement -->
      <article class="card">
        <div class="kicker">Problem</div>
        <h2>Show there exist square matrices A,B with AB ≠ BA</h2>
        <p>We will use explicit 2×2 matrices and several independent checks.</p>
        <p class="small muted">
          Notation: matrices over ℤ (integers), standard matrix product.
          “Commutative” would require AB = BA for all A,B — which is false.
        </p>
      </article>

      <!-- Answer -->
      <article class="card">
        <div class="kicker">Answer</div>
        <p class="answer ok">Not commutative. A concrete counterexample is
          <span class="mat">A = [[1,2],[0,1]]</span> and
          <span class="mat">B = [[1,0],[3,1]]</span>, for which
          <span class="mat">AB = [[7,2],[3,1]]</span> but
          <span class="mat">BA = [[1,2],[3,7]]</span>, so AB ≠ BA.</p>
      </article>

      <!-- Reason Why -->
      <article class="card">
        <div class="kicker">Reason Why</div>
        <h2>Mathematical English justification</h2>
        <ol>
          <li>Take A = [[1, 2], [0, 1]] and B = [[1, 0], [3, 1]].</li>
          <li>
            Compute AB =
            [[1·1 + 2·3, 1·0 + 2·1],
             [0·1 + 1·3, 0·0 + 1·1]]
            = [[7, 2], [3, 1]].
          </li>
          <li>
            Compute BA =
            [[1·1 + 0·0, 1·2 + 0·1],
             [3·1 + 1·0, 3·2 + 1·1]]
            = [[1, 2], [3, 7]].
          </li>
          <li>Since AB ≠ BA, matrix multiplication is not commutative in general (a single counterexample suffices).</li>
        </ol>
      </article>

      <!-- Checks -->
      <article class="card" id="h1">
        <div class="kicker">Check (harness) #1</div>
        <h3>Counterexample computation</h3>
        <p class="small muted">Compute AB and BA for the fixed A,B above.</p>
        <div class="result" id="r1"></div>
      </article>

      <article class="card" id="h2">
        <div class="kicker">Check (harness) #2</div>
        <h3>Random 2×2 integer matrices</h3>
        <p class="small muted">Sample 300 random pairs with entries in −3..3 (not all zero). Report how many satisfy AB = BA.</p>
        <div class="result" id="r2"></div>
      </article>

      <article class="card" id="h3">
        <div class="kicker">Check (harness) #3</div>
        <h3>Exhaustive tiny space</h3>
        <p class="small muted">Enumerate all 2×2 matrices with entries in {0,1} (except both zero simultaneously for all entries) and count commuting pairs.</p>
        <div class="result" id="r3"></div>
      </article>

      <article class="card" id="h4">
        <div class="kicker">Check (harness) #4</div>
        <h3>Special cases that do commute</h3>
        <p class="small muted">Identity I, zero 0, and scalars λI commute with everything; diagonal matrices commute with each other.</p>
        <div class="result" id="r4"></div>
      </article>

      <article class="card" id="h5">
        <div class="kicker">Check (harness) #5</div>
        <h3>Commutator</h3>
        <p class="small muted">Compute [A,B]=AB-BA for the counterexample; nonzero commutator certifies non-commutativity.</p>
        <div class="result" id="r5"></div>
      </article>

      <article class="card" id="h6">
        <div class="kicker">Check (harness) #6</div>
        <h3>Your matrices (CSV)</h3>
        <p class="small muted">Paste A and B as four comma-separated rows each. Example:<br>
        <code>A: 1,2; 0,1</code><br><code>B: 1,0; 3,1</code></p>
        <textarea class="input" id="csv" placeholder="A: 1,2; 0,1
B: 1,0; 3,1"></textarea>
        <div class="result" id="r6"></div>
      </article>

      <article class="card" id="h7">
        <div class="kicker">Check (harness) #7</div>
        <h3>Geometric intuition via shears</h3>
        <p class="small muted">Apply the two shears to a sample of points in both orders. The sets differ, showing the compositions differ.</p>
        <div class="result" id="r7"></div>
      </article>
    </section>
  </div>

  <script>
    // ---------- Matrix helpers ----------
    const mul = (A,B)=>{
      const r=A.length, c=B[0].length, k=A[0].length;
      const C=Array.from({length:r},()=>Array(c).fill(0));
      for(let i=0;i<r;i++){
        for(let j=0;j<c;j++){
          let s=0;
          for(let t=0;t<k;t++) s += A[i][t]*B[t][j];
          C[i][j]=s;
        }
      }
      return C;
    };
    const addM = (A,B)=>A.map((row,i)=>row.map((v,j)=>v+B[i][j]));
    const subM = (A,B)=>A.map((row,i)=>row.map((v,j)=>v-B[i][j]));
    const eqM = (A,B)=>A.length===B.length && A[0].length===B[0].length &&
      A.every((row,i)=>row.every((v,j)=>v===B[i][j]));
    const fmt = M => `[${M.map(r=>'['+r.join(', ')+']').join(', ')}]`;
    const I2 = [[1,0],[0,1]], Z2=[[0,0],[0,0]];
    const isDiag = M => M[0][1]===0 && M[1][0]===0;

    // Fixed counterexample (two shears)
    const A = [[1,2],[0,1]];
    const B = [[1,0],[3,1]];

    // ---------- Harness #1 ----------
    function check1(){
      const AB = mul(A,B), BA = mul(B,A);
      const pass = !eqM(AB,BA);
      const msg = `A = ${fmt(A)}\nB = ${fmt(B)}\nAB = ${fmt(AB)}\nBA = ${fmt(BA)}\nAB == BA ? ${eqM(AB,BA)}`;
      document.getElementById('r1').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #2 ----------
    function randInt(a,b){ return a + Math.floor(Math.random()*(b-a+1)); }
    function randomMat(){ return [[randInt(-3,3),randInt(-3,3)],[randInt(-3,3),randInt(-3,3)]]; }
    function isAllZero(M){ return M.every(r=>r.every(v=>v===0)); }
    function check2(){
      const trials=300; let commute=0, total=0;
      for(let t=0;t<trials;t++){
        let A = randomMat(), B = randomMat();
        if(isAllZero(A) && isAllZero(B)) { t--; continue; }
        total++;
        if(eqM(mul(A,B), mul(B,A))) commute++;
      }
      const msg = `Random pairs tested: ${total}\nPairs with AB = BA: ${commute}\nPairs with AB ≠ BA: ${total-commute}`;
      const pass = (total-commute)>0;
      document.getElementById('r2').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #3 ----------
    function all01Mats(){ // all 2x2 with entries in {0,1}
      const mats=[];
      for(let a=0;a<=1;a++)for(let b=0;b<=1;b++)for(let c=0;c<=1;c++)for(let d=0;d<=1;d++){
        mats.push([[a,b],[c,d]]);
      }
      return mats;
    }
    function check3(){
      const X = all01Mats();
      let commute=0, total=0;
      for(const M1 of X){
        for(const M2 of X){
          total++;
          if(eqM(mul(M1,M2), mul(M2,M1))) commute++;
        }
      }
      const msg = `Total ordered pairs (including identity & zero): ${total}\nCommuting pairs: ${commute}\nNon-commuting pairs: ${total-commute}`;
      const pass = (total-commute)>0;
      document.getElementById('r3').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #4 ----------
    function check4(){
      const lambda = 5;
      const S = [[2,0],[0,3]];      // diagonal
      const T = [[7,0],[0,-4]];     // diagonal
      const cases = [
        {name:"I commutes with A", ok: eqM(mul(I2,A), mul(A,I2))},
        {name:"0 commutes with B", ok: eqM(mul(Z2,B), mul(B,Z2))},
        {name:"λI commutes with A", ok: eqM(mul([[lambda,0],[0,lambda]],A), mul(A,[[lambda,0],[0,lambda]]))},
        {name:"Diagonal S with diagonal T", ok: eqM(mul(S,T), mul(T,S))}
      ];
      const pass = cases.every(c=>c.ok);
      const lines = cases.map(c=>`${c.name}: ${c.ok ? 'true' : 'false'}`);
      document.getElementById('r4').innerHTML =
        `<div class="${pass?'ok':'fail'}">${pass?'PASS':'FAIL'}</div><pre>${lines.join('\n')}</pre>`;
    }

    // ---------- Harness #5 ----------
    function check5(){
      const AB = mul(A,B), BA = mul(B,A);
      const comm = subM(AB, BA); // [A,B] = AB-BA
      const nz = !eqM(comm, [[0,0],[0,0]]);
      const msg = `[A,B] = AB - BA = ${fmt(comm)}\nZero? ${!nz}`;
      document.getElementById('r5').innerHTML =
        `<div class="${nz?'ok':'fail'}">${nz?'PASS (nonzero commutator)':'FAIL'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #6 ----------
    function parseCSVSpec(text){
      // Expect: A: a,b; c,d\nB: e,f; g,h
      const get = (k)=>{
        const m = (text||'').match(new RegExp(`^\\s*${k}\\s*:\\s*([^\\n]+)$`,'mi'));
        if(!m) return null;
        const rows = m[1].split(';').map(s=>s.trim());
        const nums = rows.map(r=>r.split(',').map(x=>parseFloat(x.trim())));
        if(nums.length!==2 || nums[0].length!==2 || nums[1].length!==2 || nums.flat().some(x=>Number.isNaN(x))) return null;
        return nums;
      };
      return {A:get('A'), B:get('B')};
    }
    function check6(){
      const {A,B} = parseCSVSpec(document.getElementById('csv').value);
      if(!A || !B){
        document.getElementById('r6').innerHTML =
          `<div class="fail">FAIL</div><pre>Could not parse. Example:\nA: 1,2; 0,1\nB: 1,0; 3,1</pre>`;
        return;
      }
      const AB = mul(A,B), BA = mul(B,A), same = eqM(AB,BA);
      const msg = `A = ${fmt(A)}\nB = ${fmt(B)}\nAB = ${fmt(AB)}\nBA = ${fmt(BA)}\nAB == BA ? ${same}`;
      document.getElementById('r6').innerHTML =
        `<div class="${!same?'ok':'fail'}">${!same?'PASS (non-commutative pair)':'Note: this pair commutes'}</div><pre>${msg}</pre>`;
    }

    // ---------- Harness #7 ----------
    function apply(M, v){ return [M[0][0]*v[0] + M[0][1]*v[1], M[1][0]*v[0] + M[1][1]*v[1]]; }
    function check7(){
      // Use the shear pair on a few points
      const pts = [[1,0],[0,1],[1,1],[2,-1]];
      const firstAB = pts.map(p=>apply(mul(A,B), p));
      const firstBA = pts.map(p=>apply(mul(B,A), p));
      const sameSets = JSON.stringify(firstAB)===JSON.stringify(firstBA);
      const lines = ["Points (p), (AB)p, (BA)p:"];
      for(let i=0;i<pts.length;i++){
        lines.push(`${JSON.stringify(pts[i])}  →  (AB)p=${JSON.stringify(firstAB[i])} ; (BA)p=${JSON.stringify(firstBA[i])}`);
      }
      document.getElementById('r7').innerHTML =
        `<div class="${!sameSets?'ok':'fail'}">${!sameSets?'PASS':'FAIL'}</div><pre>${lines.join('\n')}</pre>`;
    }

    // Autorun
    window.addEventListener('DOMContentLoaded', ()=>{
      const csv = document.getElementById('csv');
      if(csv && !csv.value.trim()) csv.value = "A: 1,2; 0,1\nB: 1,0; 3,1";
      check1(); check2(); check3(); check4(); check5(); check6(); check7();
    });
  </script>
</body>
</html>

